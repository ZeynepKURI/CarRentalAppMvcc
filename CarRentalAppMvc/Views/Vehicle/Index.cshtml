@{
    Layout = null;
}
@model IEnumerable<CarRentalAppMvc.Models.Vehicle>

@{
    ViewData["Title"] = "Vehicle List";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>@ViewData["Title"]</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .card-header {
            background-color: #28a745; /* Green color */
        }

        .card-body {
            background-color: #f8f9fa; /* Light gray background */
        }

        .table th {
            background-color: #e9f7e6; /* Light green background for headers */
        }

        .btn-outline-primary {
            border-color: #28a745; /* Green border */
            color: #28a745;
        }

            .btn-outline-primary:hover {
                background-color: #28a745;
                color: white;
            }

        .delete-btn {
            background-color: #dc3545;
            color: white;
        }

            .delete-btn:hover {
                background-color: #c82333;
                color: white;
            }
    </style>
</head>
<body>

    <div class="container my-5">
        <div class="card shadow-lg">
            <div class="card-header text-white text-center">
                <h2 class="mb-0">Araç Listesi</h2>
            </div>
            <div class="card-body">

                <div class="mb-3 text-end">
                    <a href="/" class="btn btn-outline-secondary">
                        <i class="bi bi-house-door-fill"></i> Anasayfaya Dön
                    </a>
                </div>

                <table class="table table-hover table-bordered align-middle">
                    <thead class="table-light">
                        <tr>
                            <th scope="col">Araç Adı</th>
                            <th scope="col">Araç Plakası</th>
                            <th scope="col">İşlemler</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var vehicle in Model)
                        {
                            <tr id="vehicle-@vehicle.Id">
                                <td>@vehicle.Name</td>
                                <td>@vehicle.LicensePlate</td>
                                <td>
                                    <div class="d-flex justify-content-center">
                                        <a href="@Url.Action("Edit", "Vehicle", new { id = vehicle.Id })" class="btn btn-sm btn-outline-primary me-2">Düzenle</a>
                                        <button class="btn btn-danger delete-btn" data-id="@vehicle.Id">Sil</button>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    @* CSRF token ekle *@
    @Html.AntiForgeryToken()

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>$(document).ready(function () {
            // Silme butonuna tıklama olayı
            $(".delete-btn").click(function () {
                var vehicleId = $(this).data("id"); // Silinecek aracın ID'si

                // Silme işlemi için onay al
                if (confirm("Are you sure you want to delete this vehicle?")) {
                    $.ajax({
                        type: "POST",
                        url: "/Vehicle/Delete", // Delete action'ının URL'si
                        data: {
                            id: vehicleId, // Gönderilecek ID verisi
                            __RequestVerificationToken: $('input[name="__RequestVerificationToken"]').val() // CSRF token
                        },
                        success: function (response) {
                            if (response.success) {
                                // Silinen aracı sayfadan kaldır
                                $("#vehicle-" + vehicleId).remove();
                                alert("Vehicle deleted successfully.");
                            } else {
                                alert("Error: " + response.message); // Hata mesajı göster
                            }
                        },
                        error: function (xhr, status, error) {
                            console.log(xhr.responseText); // Hata mesajını konsola yazdır
                            alert("Error deleting vehicle. Please check the console for details.");
                        }
                    });
                }
            });
        });</script>

</body>
</html>
